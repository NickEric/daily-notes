# 倒排索引

* 正排索引：文档ID 与 文档内容的关联
* 倒排索引：单词与文档ID 的关系



倒排索引包含两个部分

* **单词词典（Term Dictionary）**，记录所有文档的单词，记录单词到倒排列表的关联关系
  * 单词词典一般比较大，可以通过 B+ 树或哈希拉链法实现，以满足高性能的插入与查询
* **倒排列表（Posting List）**，记录了单词对应的文档结合，由倒排索引项组成
  * 倒排索引项（Posting）
    * 文档 ID
    * 词频 TF - 该单词在文档中出现的次数，用于相关性评分
    * 位置（Postion） - 单词在文档中分词的位置，用于语句搜索（phrase query）
    * 偏移（Offset） - 记录单词的开始结束位置，实现高亮显示



例如:

| 文档 ID | 文档内容                 |
| ------- | ------------------------ |
| 1       | Mastering Elasticsearch  |
| 2       | Elasticsearch Server     |
| 3       | Elasticsearch Essentials |

转为倒排索引的倒排列表（Posting List）

| Doc Id | TF   | Position | Offset  |
| ------ | ---- | -------- | ------- |
| 1      | 1    | 1        | <10,23> |
| 2      | 1    | 0        | <0,13>  |
| 3      | 1    | 0        | <0,13>  |



