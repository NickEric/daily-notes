# 字符集与编码

## 1. 字符集

计算机只支持二进制，即 0 和 1，1 字节有 8 位可以表示 0~255 ,2 字节 16 位可以表示 0~65535。



前面存储的都是整数，但是计算机中是怎么存储字符串的呢？

**其实是通过编码表（字符集）给各个字符编号，存储时只需要存储对应的编号即可。**

* 1）ASCII 字符集只收录了 128 个字符，其扩展字符集也只有 256 个。

* 2）ASCII 字符集没有汉字，所以出现了有汉字的 GB2312 字符集。

* 3）GB2312 没有繁体字，所以又出现了有繁体字的 Big5 字符集。

* n）...

就算是这样依然有很多字符没有被收录，与其一直增加新的字符集，不过实现一个全球化的通用字符集。

于是**Unicode 字符集**诞生了。Unicode 字符集实现了跨语言、跨平台的文本转换与处理。



## 2. 编码

字符集形成了字符与二进制的桥梁，但是问题来了，具体该如何编码解码？

> 即具体应该将哪一段看做一个字符？如果划分出错了最后得到的字符肯定就是错的。

比如 `hello指月`在 Unicode 中的编号如下：

> 在线查看工具 `http://www.mytju.com/classcode/tools/encode_utf8.asp`

| 字符 | 编号  | 二进制           |
| ---- | ----- | ---------------- |
| h    | 104   | 01100101         |
| e    | 101   | 01100101         |
| l    | 108   | 01101100         |
| l    | 108   | 01101100         |
| o    | 111   | 01100111         |
| 指   | 25351 | 0110001100000111 |
| 月   | 26376 | 0110011100001000 |

拼在一起就是

```go
01100101 01100101 01101100 01101100 01100111 0110001100000111 0110011100001000
```

问题来了，这么长一串数据到底该怎么分割呢？



### 1. 定长编码

最容易想到的就是直接按最长的来，位数不够的高位补零。

这样虽然可以解决问题，但是有个很明显的缺点，**浪费内存**。

而且随着收录字符的增加，编号跨度也越大，浪费的空间也会逐渐增加。



### 2. 变长编码

即小编号少占字节，大编号多占字节。

还是原来的问题，如何划分字符边界？

其中一种解决方案如下：

| 编号         | 模板                        |
| ------------ | --------------------------- |
| [0,127]      | 0？？？？？？？？           |
| [128~2047]   | 110????? 10??????           |
| [2048,65535] | 1110????? 10?????? 10?????? |

* 1）编号以`0`开头，表示只占一个字节。

* 2以`110`开头，表示占两个字节，出了当前字节外还要和后续的`10`开头的字节共同表示这个字符。

* 3）`1110`则占3个字节，后续跟着两个`10`开头共同表示一个字符。

**举个栗子**

字符`月` Unicode 编号为 26376，二进制表示为`0110011100001000`，在 [2048,65535] 这个区间，使用`1110???? 10?????? 10??????` 这个模板表示。

将二进制表示按照顺序填入模板：将前面 4 位填入第一段，中间 6 位填入第二段，最后 6 位填入第三段，结果如下：

```go
11100110 10011100 10001000
```

这就是著名的**UTF-8 编码**。







